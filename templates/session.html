<!DOCTYPE HTML>
<html>
	<head>
		<title>Remedy AI</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="{{ url_for('static',filename='styles/main.css') }}" />
		<noscript><link rel="stylesheet" href="{{ url_for('static',filename='styles/noscript.css') }}" /></noscript>
	</head>
	<body class="is-preload">

		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Header -->
					<header id="header" class="alt">
						<h1>Remedy AI</h1>
					</header>
				<!-- Main -->
					<div id="main">

						<!-- Introduction -->
							<section id="intro" class="main">
								<div class="spotlight">
									<div class="content">
										<header class="major">
										</header>
                          <div id="chat-container">
                              <div id="chat-messages">
                                  <!-- Chat messages will appear here -->
                              </div>
                                <input type="text" name = "user-input" id="user-input" placeholder="Type your message...">
                                <button type="submit" id="send-button" onclick="sendMessage()">Send</button>
                          </div>
								</div>
							</section>


					</div>

		<!-- Scripts -->
			<script src="{{ url_for('static',filename='scripts/jquery.min.js') }}"></script>
			<script src="{{ url_for('static',filename='scripts/jquery.scrollex.js') }}"></script>
			<script src="{{ url_for('static',filename='scripts/browser.min.js') }}"></script>
			<script src="{{ url_for('static',filename='scripts/breakpoints.min.js') }}"></script>
			<script src="{{ url_for('static',filename='scripts/util.js') }}"></script>
			<script src="{{ url_for('static',filename='scripts/main.js') }}"></script>

	</body>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script>
  function sendMessage() {
      var userInput = document.getElementById("user-input").value;
      if (userInput.trim() !== "") {
          var chatMessages = document.getElementById("chat-messages");
          var userMessage = document.createElement("div");
          userMessage.className = "user-message";
          userMessage.innerHTML = "<strong>You:</strong> " + userInput + '\n';
          chatMessages.appendChild(userMessage);

          var botMessage = document.createElement("div");
          botMessage.innerHTML = "<em>Remedy is typing...</em> ";
          chatMessages.appendChild(botMessage);
          document.getElementById("user-input").value = "";


          $.ajax({ 
              url: '/process', 
              type: 'POST', 
              contentType: 'application/json', 
              data: JSON.stringify({ 'value': userInput }), 
              success: function(response) { 
                  chatMessages.removeChild(chatMessages.lastChild);
                  var botMessage = document.createElement("div");
                  botMessage.innerHTML = "<strong>Remedy:</strong> " + response.result + '\n';
                  chatMessages.appendChild(botMessage);
              }, 
              error: function(error) { 
                  console.log(error); 
              },
              always: function(e){
                document.getElementById("user-input").value = "";
                chatMessages.scrollTop = chatMessages.scrollHeight;
              } 
          }); 
      
        } 


      }
  
  document.getElementById("user-input").addEventListener("keydown", function(event) {
      if (event.key === "Enter") {
          sendMessage();
      }
  })
</script>